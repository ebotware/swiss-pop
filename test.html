<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leaflet – Fixed-size colored squares</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  crossorigin=""></script>

  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 100%; }
  </style>
</head>
<body>

<div id="map"></div>

<script>
// ────────────────────────────────────────────────
//   CONFIGURATION
// ────────────────────────────────────────────────

const SQUARE_SIZE_METERS = 400;           // side length in meters
const SQUARE_COLOR       = '#e74c3c';     // red-ish
const SQUARE_OPACITY     = 0.65;
const SQUARE_WEIGHT      = 2;             // border thickness

// Example input coordinates (you can replace this array)
const coordinates = [
  [46.003,     8.961],   // Lugano centro
  [46.0105,    8.9605],
  [46.005,     8.952],
  [46.0078,    8.975],
  [46.0182,    8.942],
];

// ────────────────────────────────────────────────
//   HELPERS
// ────────────────────────────────────────────────

function metersToDegreesAtLatitude(lat, meters) {
  // Rough approximation – good enough for most purposes < 1000 km from equator
  const metersPerDegreeLat = 111111;                    // ≈ at equator
  const metersPerDegreeLon = 111111 * Math.cos(lat * Math.PI / 180);
  
  const deltaLat = meters / metersPerDegreeLat;
  const deltaLon = meters / metersPerDegreeLon;
  
  return { deltaLat, deltaLon };
}

function createSquare(lat, lng, sizeMeters, color) {
  const { deltaLat, deltaLon } = metersToDegreesAtLatitude(lat, sizeMeters / 2);
  
  const bounds = [
    [lat - deltaLat, lng - deltaLon],   // southwest
    [lat + deltaLat, lng + deltaLon]    // northeast
  ];
  
  return L.rectangle(bounds, {
    color:       color,
    weight:      SQUARE_WEIGHT,
    opacity:     0,
    fillColor:   color,
    fillOpacity: SQUARE_OPACITY,
    // You can add: interactive: false  if you don't want popups/tooltips
  });
}

// ────────────────────────────────────────────────
//   MAP SETUP
// ────────────────────────────────────────────────

const map = L.map('map', {
  center: [46.003, 8.961],
  zoom: 15,
  // zoomSnap: 0.25,    // uncomment if you want finer zoom control
});

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
}).addTo(map);

// ────────────────────────────────────────────────
//   DRAW SQUARES
// ────────────────────────────────────────────────

const squaresLayer = L.layerGroup().addTo(map);

coordinates.forEach(([lat, lng]) => {
  const square = createSquare(lat, lng, SQUARE_SIZE_METERS, SQUARE_COLOR);
  squaresLayer.addLayer(square);
  
  // Optional: label / tooltip
  square.bindTooltip(`Square @ ${lat.toFixed(4)}, ${lng.toFixed(4)}`, {
    permanent: false,
    direction: 'center',
    className: 'square-tooltip'
  });
});

// Optional: fit view to all squares + some margin


</script>

</body>
</html>